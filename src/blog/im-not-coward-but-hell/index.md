---
title: 'Я не трус, но чёрт возьми!'
date: 2008-08-30
tags: post
layout: post.njk
---

И вроде ничего страшного — ну [вышел IE8 beta 2](http://blogs.msdn.com/ie/archive/2008/08/27/internet-explorer-8-beta-2-now-available.aspx), ну добавили поддержку каких-то новых свойств из стандарта CSS 2.1. Сиди себе и жди финальную версию где-нибудь поздней осенью. А там что? Никакого тебе hasLayout, никаких expression — словом, никаких привычных методов борьбы с багами…

И поэтому немного страшно.

Для тех, кто не хочет, чтобы было страшно, есть два решения. Первое — поверить лозунгам Microsoft, что, мол, мы делаем браузер ориентированный на полную поддержку веб-стандартов. Что ж — отлично, значит, во избежание каких-то проблем, нужно просто не отдавать IE8 файлы хаков:

    <head>
        <link rel="stylesheet" type="text/css" href="style.css">
        <!--[if lt IE 8]>
            <link rel="stylesheet" type="text/css" href="ie.css">
        <![endif]-->
    </head>

«Если версия IE младше, чем восьмая, то подключаем файл с хаками», — говорит нам этот код. В результате, мы в полной мере доверяем той поддержке веб-стандартов, а также тем багам, которые безусловно всплывут после выхода IE8. Благородно до умиления, но, по мне, слишком рисково.

Второй вариант существует благодаря паранойе Microsoft по поводу обратной совместимости. С другой стороны, их можно понять — у них на совести столько лет наплевательства на развитие собственного браузера. Называется этот переключатель `X-UA-Compatible` и включает в IE8 режим особый режим рендеринга не запутанными схемами `DOCTYPE`, а вполне ясным указанием:

    <meta http-equiv="X-UA-Compatible" content="IE=7">

«Запустим-ка сайт в режиме совместимости с IE7», — говорит нам этот код. Что значит, что IE8 использует для рендеринга вашего кода один из трёх (sic!) движков, что спрятаны у него под капотом, а именно режим _совместимости со стандартами_ (standard compliance mode), который включается в IE6–7 при наличии правильного `DOCTYPE`. Оставшиеся два — это хвалёный _режим соответствия стандартам_ (super standard mode) и конечно же _режим уловок_ (quirks mode).

Отдельного изучения заслуживает вопрос комбинации `X-UA-Compatible` с различными `DOCTYPE`. В рассматриваемых примерах, IE6–7 по умолчанию переключаются в режим совместимости со стандартами правильным `DOCTYPE`.

Итак, комбинируем:

    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=7">
        <link rel="stylesheet" type="text/css" href="style.css">
        <!--[if IE]>
            <link rel="stylesheet" type="text/css" href="ie.css">
        <![endif]-->
    </head>

…в этом случае IE8 работает в точности как IE7, бороться с котрым мы уже более-менее научились. Для полной уверенности включим `X-UA-Compatible` со значением **IE7** и проверим:

    <!--[if IE 8]>IE8<![endif]-->
    <!--[if IE 7]>IE7<![endif]-->

В результате IE7, как и IE8 beta 2, выведут «IE7».

Таким образом, мы можем подстраховаться на случай, если финальная версия IE8 окажется такой же сырой бетой, как текущая бета кажется скорее сырой альфой — как [метко выразился](http://habrahabr.ru/blogs/microsoft/38301/#comment_905394) на Хабре [Марат Таналин](http://tanalin.com/).
